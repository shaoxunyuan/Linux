<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Linux基础及应用教程：文本三剑客之 grep</title>

  <!-- Markdown 样式 -->
  <link rel="stylesheet" href="docs/markdown-style.css">

  <!-- Prism 代码高亮 -->
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet">

  <!-- 图标库 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">

  <style>
    .sidebar-nav {
      position: fixed;
      left: 0;
      top: 0;
      width: 220px;
      height: 100vh;
      background-color: #f5f5f5;
      border-right: 1px solid #ddd;
      padding: 20px 0;
      overflow-y: auto;
      box-sizing: border-box;
      z-index: 999;
    }

    .nav-title {
      font-size: 18px;
      font-weight: bold;
      padding: 0 20px 15px;
      border-bottom: 1px solid #ddd;
      margin-bottom: 15px;
      color: #333;
    }

    .nav-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .nav-list li a {
      display: block;
      padding: 8px 25px;
      color: #333;
      text-decoration: none;
      font-size: 14px;
      transition: background-color 0.2s;
    }

    .nav-list li a:hover { background-color: #e0e0e0; }

    .sub-nav {
      list-style: none;
      padding-left: 15px;
      background-color: #fafafa;
    }

    .sub-nav li a {
      padding-left: 35px;
      font-size: 13px;
      color: #666;
    }

    .markdown-body {
      margin-left: 240px;
      padding: 20px 40px;
      max-width: 1200px;
      box-sizing: border-box;
    }

    .code-block { position: relative; margin: 15px 0; }

    .copy-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: rgba(255,255,255,0.9);
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 4px 8px;
      cursor: pointer;
      font-size: 14px;
      color: #666;
      transition: all 0.2s;
      z-index: 10;
    }

    .copy-btn:hover { background-color: #fff; color: #333; border-color: #bbb; }
    .copy-btn.success { background-color: #4CAF50; color: white; border-color: #4CAF50; }
    .copy-btn.success i::after { content: " 已复制"; font-family: sans-serif; }

    /* 右下角固定按钮 */
    .back-home-fixed {
      position: fixed;
      bottom: 25px;
      right: 25px;
      background-color: #3498db;
      color: #fff;
      padding: 10px 18px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 14px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.25);
      transition: background-color 0.25s;
      z-index: 9999;
    }
    .back-home-fixed:hover { background-color: #217dbb; }

    @media (max-width: 768px) {
      .sidebar-nav { display: none; }
      .markdown-body { margin-left: 0; padding: 20px; }
    }
  </style>
</head>
<body>

  <!-- 左侧导航 -->
  <nav class="sidebar-nav">
    <div class="nav-title">实验目录</div>
    <ul class="nav-list">
      <li><a href="#linux基础及应用教程：文本三剑客之grep">实验标题</a></li>
      <li><a href="#一、实验目标">一、实验目标</a></li>
      <li><a href="#二、实验环境">二、实验环境</a></li>
      <li>
        <a href="#三、实验内容与步骤">三、实验内容与步骤</a>
        <ul class="sub-nav">
          <li><a href="#实验准备">实验准备</a></li>
          <li><a href="#任务1-grep基础搜索">任务1：基础搜索</a></li>
          <li><a href="#任务2-忽略大小写-i">任务2：忽略大小写</a></li>
          <li><a href="#任务3-行号统计-n-c">任务3：行号 + 计数</a></li>
          <li><a href="#任务4-反向查找-v">任务4：反向查找</a></li>
          <li><a href="#任务5-整行匹配-x">任务5：整行匹配</a></li>
          <li><a href="#任务6-正则表达式匹配">任务6：正则表达式</a></li>
          <li><a href="#任务7-递归搜索-r">任务7：递归搜索</a></li>
          <li><a href="#任务8-高亮显示color">任务8：高亮匹配</a></li>
          <li><a href="#任务9-结合管道使用">任务9：结合管道</a></li>
          <li><a href="#任务10-长度匹配练习">任务10：字符串长度练习</a></li>
          <li><a href="#综合实操练习">综合实操练习</a></li>
        </ul>
      </li>
      <li><a href="#四、实验报告要求">四、实验报告要求</a></li>
      <li><a href="#五、常见问题解答">五、常见问题解答</a></li>
    </ul>
  </nav>

  <!-- 主体内容 -->
  <article class="markdown-body">

    <h1 id="linux基础及应用教程：文本三剑客之grep">Linux基础及应用教程：文本三剑客之 grep</h1>
    <p><code>grep</code> 是 Linux 文本处理三剑客之一，用于<strong>查找、过滤、正则匹配和日志分析</strong>，是运维工程师、文本处理人员必学工具。</p>

    <h2 id="一、实验目标">一、实验目标</h2>
    <ul>
      <li>掌握 grep 的基础查找功能</li>
      <li>理解大小写忽略、反向匹配、行号显示等常用参数</li>
      <li>能使用正则表达式进行高级匹配</li>
      <li>掌握递归搜索目录/日志的方法</li>
      <li>理解 grep 在实际日志分析中的典型用法</li>
    </ul>

    <h2 id="二、实验环境">二、实验环境</h2>
    <ul>
      <li>平台：VMware 虚拟机</li>
      <li>系统：CentOS 7 / 8</li>
      <li>普通用户：<code>njucm</code>（密码 123456）</li>
      <li>root 密码：<code>123456</code></li>
    </ul>

    <h2 id="三、实验内容与步骤">三、实验内容与步骤</h2>

    <h3 id="实验准备">实验准备</h3>
    <p>创建实验目录并准备测试文本。</p>

    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">mkdir -p ~/grep_lab
cd ~/grep_lab

# simple.txt
cat > simple.txt << EOF
Hello World
hello world
HELLO WORLD
This is a grep test file.
Linux is powerful.
Text filtering with grep is easy.
EOF

# logs.txt
cat > logs.txt << EOF
2024-01-01 INFO User login success
2024-01-01 ERROR Cannot connect to database
2024-01-02 WARN  Disk space low
2024-01-03 ERROR File not found
2024-01-04 INFO  Task finished
EOF

# data.txt
cat > data.txt << EOF
apple
banana
orange
grape
pineapple
blueberry
blackberry
EOF</code></pre>
    </div>

    <!-- 任务1 -->
    <h3 id="任务1-grep基础搜索">任务1：grep 基础搜索</h3>
    <p>最基本的查找文本中包含某字符串的行。</p>

    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep "hello" simple.txt
grep "INFO" logs.txt</code></pre>
    </div>

    <!-- 任务2 -->
    <h3 id="任务2-忽略大小写-i">任务2：忽略大小写 -i</h3>
    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep -i "hello" simple.txt</code></pre>
    </div>

    <!-- 任务3 -->
    <h3 id="任务3-行号统计-n-c">任务3：行号与计数（-n / -c）</h3>
    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep -n "ERROR" logs.txt
grep -c "ERROR" logs.txt</code></pre>
    </div>

    <!-- 任务4 -->
    <h3 id="任务4-反向查找-v">任务4：反向查找 -v</h3>
    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep -v "INFO" logs.txt</code></pre>
    </div>

    <!-- 任务5 -->
    <h3 id="任务5-整行匹配-x">任务5：整行匹配 -x</h3>
    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep -x "apple" data.txt</code></pre>
    </div>

    <!-- 任务6 -->
    <h3 id="任务6-正则表达式匹配">任务6：正则表达式匹配</h3>
    <p>使用 <code>grep -E</code> 或 <code>egrep</code> 启用扩展正则。</p>

    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash"># 开头匹配
grep "^2024" logs.txt

# 结尾匹配
grep "success$" logs.txt

# 任意字符
grep ".... error" simple.txt

# 字符集匹配
grep "b[a-z]nana" data.txt

# 扩展正则
grep -E "apple|banana" data.txt
grep -E "^(ERROR|WARN)" logs.txt</code></pre>
    </div>

    <!-- 任务7 -->
    <h3 id="任务7-递归搜索-r">任务7：递归搜索目录 -r</h3>

    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">mkdir -p nested/logs
cp logs.txt nested/logs/log1.txt
cp logs.txt nested/logs/log2.txt

grep -r "ERROR" nested/</code></pre>
    </div>

    <!-- 任务8 -->
    <h3 id="任务8-高亮显示color">任务8：高亮显示 --color</h3>

    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep --color=auto "ERROR" logs.txt</code></pre>
    </div>

    <!-- 任务9 -->
    <h3 id="任务9-结合管道使用">任务9：结合管道使用</h3>

    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep "ERROR" logs.txt | sort
grep "ERROR" logs.txt | grep -v "database"
grep "ERROR" logs.txt | wc -l</code></pre>
    </div>

    <!-- 任务10 -->
    <h3 id="任务10-长度匹配练习">任务10：长度匹配练习</h3>

    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep -E "^.{7,}$" data.txt</code></pre>
    </div>

    <!-- 综合实操 -->
    <h3 id="综合实操练习">综合实操练习</h3>
    <p>找出：所有 ERROR 且日期为 2024-01-01 且不包含 database 的日志。</p>

    <div class="code-block">
      <button class="copy-btn"><i class="fa fa-clipboard"></i></button>
      <pre><code class="language-bash">grep "2024-01-01" logs.txt \
  | grep "ERROR" \
  | grep -v "database"</code></pre>
    </div>

    <h2 id="四、实验报告要求">四、实验报告要求</h2>
    <ul>
      <li>截图记录每个任务运行结果</li>
      <li>总结 grep 常用参数：-i、-n、-v、-E、-r 等</li>
      <li>写出不少于 5 个正则匹配示例</li>
      <li>设计至少一个“多重过滤”命令并解释其作用</li>
    </ul>

    <h2 id="五、常见问题解答">五、常见问题解答</h2>
    <ul>
      <li><strong>Q：grep 默认是否使用正则？</strong>  
      A：是，但默认是基础正则（BRE）。扩展正则要用 <code>-E</code>。</li>

      <li><strong>Q：为什么搜索区分大小写？</strong>  
      A：默认大小写敏感，可使用 <code>-i</code>。</li>

      <li><strong>Q：grep 搜索目录时报错 "Is a directory"？</strong>  
      A：需使用 <code>-r</code> 递归模式。</li>

      <li><strong>Q：如何匹配多个关键词？</strong>  
      A：使用 <code>grep -E "k1|k2"</code> 或多次管道。</li>
    </ul>

  </article>

  <!-- 右下角回到主页按钮 -->
  <a href="https://shaoxunyuan.github.io/Linux" class="back-home-fixed">回到主页</a>

  <!-- JS：复制代码 / 平滑跳转 -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
  <script>
    // 代码复制
    document.querySelectorAll('.copy-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const code = this.nextElementSibling.querySelector('code').textContent;
        navigator.clipboard.writeText(code).then(() => {
          this.classList.add('success');
          setTimeout(() => { this.classList.remove('success'); }, 2000);
        });
      });
    });

    // 平滑导航滚动
    document.querySelectorAll('.sidebar-nav a').forEach(anchor => {
      anchor.addEventListener('click', function(e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          window.scrollTo({ top: target.offsetTop - 20, behavior: 'smooth' });
        }
      });
    });
  </script>

</body>
</html>
